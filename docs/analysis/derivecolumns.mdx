---
id: derivecolumns
title: Derive columns in a dataframe
sidebar_label: Derive columns
keywords:
  - analysis
  - dataframe
---

Deriving a new column in a dataset / dataframe &mdash; either deriving a constant / static value or deriving a new value from other columns in the dataset / dataframe.

Makes use of the [person](../gettingstarted/rowwiseinit) dataset / dataframe.

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs
  defaultValue={(() => {
    let langs = ['sas', 'py', 'r', 'julia'];
    return(langs[Math.floor(Math.random()*langs.length)]);
  })()}
  values={[
    { label: 'SAS', value: 'sas', },
    { label: 'Python', value: 'py', },
    { label: 'R', value: 'r', },
    { label: 'Julia', value: 'julia', },
  ]
}>
<TabItem value="sas">

```sas
*****************************;
** constant / static value **;
*****************************;

data person2;
  set person;
  
  hungry = "yes";
run;

proc sql noprint;
  create table person2b as
  select  *
         ,"yes" as hungry
  from person
  ;
quit;



******************;
** derive value **;
******************;

data person3;
  set person;
  
  if sweet_tooth = "yes" and
     substr(lowcase(name), 1, 1) in ("a", "e", "i", "o", "u") then hungry = "yes";
  else hungry = "no";
run;

proc sql noprint;
  create table person3b as
  select  *
         ,case
            when sweet_tooth = "yes" and
                 substr(lowcase(name), 1, 1) in ("a", "e", "i", "o", "u") then "yes"
            else "no"
          end as hungry
  from person
  ;
quit;
```

</TabItem>
<TabItem value="py">

```py
import pandas as pd

######################
## single condition ##
######################

# boolean expression
sweet_tooth_bool = person[person['sweet_tooth']=="yes"]

# query
sweet_tooth_query = person.query('sweet_tooth=="yes"')



##########################
## multiples conditions ##
##########################

# boolean expression
sweet_tooth_older_bool = person[(person['sweet_tooth']=="yes") & (person['age'] > 20)]

# query
sweet_tooth_older_query = person.query('sweet_tooth=="yes" & age > 20')
```

</TabItem>
<TabItem value="r">

```r
library(dplyr)

######################
## single condition ##
######################

# base
sweet_tooth_base <- person[person[["sweet_tooth"]] == "yes",]

# dplyr
sweet_tooth_dplyr <- person %>%
  filter(sweet_tooth == "yes")



#########################
## multiple conditions ##
#########################

# base
sweet_tooth_older_base <- person[person[["sweet_tooth"]] == "yes" &
                                 person[["age"]] > 20,]

# dplyr
sweet_tooth_older_dplyr <- person %>%
  filter(sweet_tooth == "yes",
         age > 20)
```

</TabItem>
<TabItem value="julia">

```julia
using DataFrames, Query

######################
## single condition ##
######################

# Query - stand alone
sweet_tooth_sa = person |>
    @filter(_.sweet_tooth=="yes") |>
    DataFrame

# Query - LINQ
sweet_tooth_q = @from i in person begin
    @where i.sweet_tooth=="yes"
    @select i
    @collect DataFrame
end


#########################
## multiple conditions ##
#########################

# Query - stand alone
sweet_tooth_older_sa = person |>
    @filter(_.sweet_tooth=="yes" && _.age > 20) |>
    DataFrame

# Query - LINQ
sweet_tooth_older_q = @from i in person begin
    @where i.sweet_tooth=="yes" && i.age > 20
    @select i
    @collect DataFrame
end
```

</TabItem>
</Tabs>
